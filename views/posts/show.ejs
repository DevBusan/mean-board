<!-- new.ejs -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <% include ../partials/head %>
</head>

<body>
    <% include ../partials/nav %>

    <div class="posts posts-show container">
        <% include ./partials/title %>

            <div class="page-header">
                <h3>
                    <%= post.title %>
                </h3>
            </div>

            <div class="post-info">
                <div><span>Created</span> :
                    <%= post.createdDate %>
                        <%= post.createdTime %>
                </div>
                <% if(post.updatedAt) { %>
                    <div><span>Updated</span> :
                        <%= post.updatedDate %>
                            <%= post.updatedTime %>
                    </div>
                    <% } %>
            </div>

            <div class="post-body body">
                <%= post.body %>
            </div>

            <div>
                <a href="/posts" class="btn btn-default">Back</a>
                <div class="pull-right">
                    <a href="/posts/<%= post._id %>/edit" class="btn btn-default">Edit</a>
                    <form action="/posts/<%= post.id %>?_method=delete" method="post" class="post-delete">
                        <a href="#" class="btn btn-default" onclick="confirm('Do you want to delete this post?')?this.parentElement.submit():null;">Delete</a>
                    </form>
                </div>
            </div>
            <p></p>

            <div class="well">
                <h4>댓글작성</h4>
                <form id="commentForm" action="/posts/comment/<%= post._id%>" method="POST" role="form" class="clearfix">
                    <div class="col-md-6 form-group">
                        <label class="sr-only" for="com_name">Name</label>
                        <input type="text" class="form-control" id="com_name" name="com_name" placeholder="Name">
                    </div>
                    <div class="col-md-6 form-group">
                        <label class="sr-only" for="com_email">Email</label>
                        <input type="email" class="form-control" id="com_email" name="com_email" placeholder="Email">
                    </div>
                    <div class="col-md-12 form-group">
                        <label class="sr-only" for="com_memo">Comment</label>
                        <textarea class="form-control" id="com_memo" name="com_memo" placeholder="Comment" rows="5" wrap="hard" ></textarea>
                    </div>
                    <div class="col-md-12 form-group text-right">
                        <button type="submit" class="btn btn-primary">저장</button>
                    </div>
                </form>
            </div>
            <p></p>

            <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                    <% if( post.comments.length != 0) { %>                                            
                        <h3>댓글</h3>
                    <% } %>                    
                    </div>
                </div>
                
                <% for (var i = 0; i < post.comments.length; i++) { %>
                <div class="row">
                    <div class="col-sm-1">
                        <div class="thumbnail" style="text-align: center">
                            <!--<img class="img-responsive user-photo" src="https://ssl.gstatic.com/accounts/ui/avatar_2x.png">-->
                            <span class="glyphicon glyphicon-user" style="font-size:30px"></span>
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <strong><%= post.comments[i].writer %></strong> &nbsp; 
                                <span class="text-muted"><%= dateFormat(post.comments[i].writeDate) %></span>
                                <a href="mailto:<%= post.comments[i].email %>">
                                    <span class="glyphicon glyphicon-envelope"></span>
                                </a>
                            </div>
                            <div class="panel-body">
                                <%= replaceNewLine(post.comments[i].memo) %>
                            </div>
                        </div>
                    </div>
                </div>                
                <% } %>              
            </div>            
        </div>
</body>

</html>